<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="test.css">
    <title>五子棋游戏(200110632)</title>
</head>

<body>
    <h1>在线五子棋小游戏2023</h1>
    <table>
        <tr>
            <td>Player1 :</td>
            <td>Black</td>
            <td>Player2 :</td>
            <td>White</td>
        </tr>
        <td id="ty">
            Your Turn!
        </td>
        <td id="by">
            Your Are Black!
        </td>
        <td id="find">
            Searching player……
        </td>
    </table>

</body>
<div>
    <input type="image" id=" 00" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 00")'>
    <input type="image" id=" 01" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 01")'>
    <input type="image" id=" 02" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 02")'>
    <input type="image" id=" 03" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 03")'>
    <input type="image" id=" 04" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 04")'>
    <input type="image" id=" 05" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 05")'>
    <input type="image" id=" 06" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 06")'>
    <input type="image" id=" 07" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 07")'>
    <input type="image" id=" 08" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 08")'>
    <input type="image" id=" 09" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 09")'>

</div>

<div>
    <input type="image" id=" 10" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 10")'>
    <input type="image" id=" 11" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 11")'>
    <input type="image" id=" 12" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 12")'>
    <input type="image" id=" 13" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 13")'>
    <input type="image" id=" 14" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 14")'>
    <input type="image" id=" 15" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 15")'>
    <input type="image" id=" 16" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 16")'>
    <input type="image" id=" 17" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 17")'>
    <input type="image" id=" 18" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 18")'>
    <input type="image" id=" 19" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 19")'>
</div>

<div>
    <input type="image" id=" 20" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 20")'>
    <input type="image" id=" 21" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 21")'>
    <input type="image" id=" 22" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 22")'>
    <input type="image" id=" 23" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 23")'>
    <input type="image" id=" 24" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 24")'>
    <input type="image" id=" 25" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 25")'>
    <input type="image" id=" 26" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 26")'>
    <input type="image" id=" 27" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 27")'>
    <input type="image" id=" 28" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 28")'>
    <input type="image" id=" 29" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 29")'>
</div>

<div>
    <input type="image" id=" 30" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 30")'>
    <input type="image" id=" 31" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 31")'>
    <input type="image" id=" 32" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 32")'>
    <input type="image" id=" 33" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 33")'>
    <input type="image" id=" 34" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 34")'>
    <input type="image" id=" 35" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 35")'>
    <input type="image" id=" 36" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 36")'>
    <input type="image" id=" 37" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 37")'>
    <input type="image" id=" 38" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 38")'>
    <input type="image" id=" 39" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 39")'>
</div>
<div>
    <input type="image" id=" 40" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 40")'>
    <input type="image" id=" 41" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 41")'>
    <input type="image" id=" 42" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 42")'>
    <input type="image" id=" 43" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 43")'>
    <input type="image" id=" 44" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 44")'>
    <input type="image" id=" 45" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 45")'>
    <input type="image" id=" 46" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 46")'>
    <input type="image" id=" 47" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 47")'>
    <input type="image" id=" 48" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 48")'>
    <input type="image" id=" 49" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 49")'>
</div>
<div>
    <input type="image" id=" 50" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 50")'>
    <input type="image" id=" 51" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 51")'>
    <input type="image" id=" 52" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 52")'>
    <input type="image" id=" 53" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 53")'>
    <input type="image" id=" 54" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 54")'>
    <input type="image" id=" 55" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 55")'>
    <input type="image" id=" 56" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 56")'>
    <input type="image" id=" 57" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 57")'>
    <input type="image" id=" 58" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 58")'>
    <input type="image" id=" 59" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 59")'>
</div>
<div>
    <input type="image" id=" 60" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 60")'>
    <input type="image" id=" 61" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 61")'>
    <input type="image" id=" 62" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 62")'>
    <input type="image" id=" 63" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 63")'>
    <input type="image" id=" 64" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 64")'>
    <input type="image" id=" 65" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 65")'>
    <input type="image" id=" 66" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 66")'>
    <input type="image" id=" 67" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 67")'>
    <input type="image" id=" 68" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 68")'>
    <input type="image" id=" 69" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 69")'>
</div>
<div>
    <input type="image" id=" 70" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 70")'>
    <input type="image" id=" 71" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 71")'>
    <input type="image" id=" 72" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 72")'>
    <input type="image" id=" 73" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 73")'>
    <input type="image" id=" 74" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 74")'>
    <input type="image" id=" 75" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 75")'>
    <input type="image" id=" 76" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 76")'>
    <input type="image" id=" 77" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 77")'>
    <input type="image" id=" 78" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 78")'>
    <input type="image" id=" 79" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 79")'>
</div>
<div>
    <input type="image" id=" 80" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 80")'>
    <input type="image" id=" 81" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 81")'>
    <input type="image" id=" 82" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 82")'>
    <input type="image" id=" 83" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 83")'>
    <input type="image" id=" 84" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 84")'>
    <input type="image" id=" 85" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 85")'>
    <input type="image" id=" 86" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 86")'>
    <input type="image" id=" 87" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 87")'>
    <input type="image" id=" 88" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 88")'>
    <input type="image" id=" 89" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 89")'>
</div>
<div>
    <input type="image" id=" 90" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 90")'>
    <input type="image" id=" 91" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 91")'>
    <input type="image" id=" 92" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 92")'>
    <input type="image" id=" 93" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 93")'>
    <input type="image" id=" 94" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 94")'>
    <input type="image" id=" 95" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 95")'>
    <input type="image" id=" 96" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 96")'>
    <input type="image" id=" 97" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 97")'>
    <input type="image" id=" 98" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 98")'>
    <input type="image" id=" 99" src="../P1Materials/background.gif" alt="background.gif" onclick='xia(" 99")'>
</div>

<script>
    var ws = new WebSocket("ws://localhost:9999");
    //var ws = new WebSocket("ws://8.130.91.197:8081");
    var color = "black";
    var pid;
    ws.onopen = function () {
        var firstmsg = JSON.stringify({
            "type": "first",
            "color": "black",
            "conf": "no"
        });
        ws.send(firstmsg);
    }
    function xia(id) {
        var i = parseInt(id);
        console.log("id:")
        console.log(i);
        mesF(id);
    }
    function xBlack(ds) {
        const el = document.getElementById(ds);
        el.src = "../P1Materials/blackStone.gif";
    }
    function xWhite(ds) {
        document.getElementById(ds).src = "../P1Materials/whiteStone.gif";
    }
    ws.onmessage = function (message) {

        var msg = JSON.parse(message.data);
        switch (msg.type) {
            case "set":
                color = msg.color;

                if (color == "white") {
                    playerNT();
                    document.getElementById("by").innerText = "You are white!";
                }
                console.log(msg);
                console.log(msg.conf);
                if (msg.conf == "yes") {
                    console.log("find");
                    findP();
                    pid = msg.pid;
                }
                break;
            case "msg":
                if (msg.color == "black") {
                    xBlack(msg.idd);
                }
                else {
                    xWhite(msg.idd);
                }

                if (msg.color == color) {
                    playerNT();
                }
                else {
                    playerT();
                }
                break;
            case "close":
                closeP();
                break;
        }
    }

    window.onbeforeunload = function () {
        var mesC = JSON.stringify({
            "type": "close",
            "pid" : pid
        });
        ws.send(mesC);
        ws.close();
    }

    function mesF(idnum) {
        var mes = JSON.stringify({
            "type": "msg",
            "idd": idnum,
            "color": color,
            "pid": pid
        });
        ws.send(mes);
    }

    function playerT() {
        var xtd = document.getElementById("ty");
        xtd.innerText = " Your turn!"
    }
    function playerNT() {
        var xtd = document.getElementById("ty");
        xtd.innerText = " Not Your turn!"
    }
    function findP() {
        var xtd = document.getElementById("find");
        xtd.innerText = "Find!"
    }
    function closeP() {
        var xtd = document.getElementById("find");
        xtd.innerText = "Game Over! 对手润力"
        ws.close();
    }
</script>

</html>